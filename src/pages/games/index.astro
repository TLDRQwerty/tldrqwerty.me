---
import Link from "@components/Link.astro";
import Site from "@layouts/Site.astro";
import Image from "@components/Image.astro";

import { getOwnedGames } from "@services/steam";

const games = await getOwnedGames();

games.sort((a, b) => {
  if (a.playtime_forever > b.playtime_forever) return -1;
  if (a.playtime_forever < b.playtime_forever) return 1;
  return 0;
});
---

<Site title="Games">
  <h1>Games</h1>

  <ul class="grid grid-cols-3 lg:grid-cols-4 2xl:grid-cols-5 gap-4">
    {
      games.map((game) => (
        <li>
          <Link href={`/games/${game.appid}`}>
            <Image
              src={`https://cdn.akamai.steamstatic.com/steam/apps/${game.appid}/header.jpg?`}
              alt={game.name}
            />
            <p>{game.name}</p>
            <p>{(game.playtime_forever / 60).toFixed(1)} Hours</p>
          </Link>
        </li>
      ))
    }
  </ul>
</Site>
